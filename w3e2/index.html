<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MNIST CNN + Denoising Autoencoder</title>

  <!-- TensorFlow.js & tfjs-vis CDNs -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@latest"></script>

  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* Pink-themed, clean two-column layout and horizontal preview strip */
    :root{
      --pink-1: #f8c8dc;
      --pink-2: #f3a7c3;
      --pink-3: #e75480;
      --card-bg: rgba(255,255,255,0.9);
      --muted: #444;
      --success: #1b9a59;
      --danger: #d43f5a;
    }
    html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;background:var(--pink-1);color:var(--muted);}
    header{
      background: linear-gradient(90deg,var(--pink-3),var(--pink-2));
      color:white;padding:14px 18px;font-weight:600;font-size:18px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.12);
    }
    main{display:flex;gap:18px;padding:18px;box-sizing:border-box;height:calc(100vh - 72px);}
    .col{flex:1;min-width:320px;background:var(--card-bg);border-radius:10px;padding:16px;box-shadow:0 6px 20px rgba(0,0,0,0.07);overflow:auto;}
    .left{max-width:420px;}
    h2{margin:0 0 10px 0;font-size:16px;color:#222;}
    label{display:block;margin:8px 0;font-size:13px;}
    input[type="file"]{display:block;margin-top:6px;}
    .controls{display:flex;flex-direction:column;gap:8px;}
    button{
      padding:10px;border-radius:8px;border:none;font-weight:600;cursor:pointer;
      background:var(--pink-3);color:white;font-size:14px;
      box-shadow:0 3px 8px rgba(231,84,128,0.18);
    }
    button.secondary{background:transparent;color:var(--muted);border:1px solid rgba(0,0,0,0.06);box-shadow:none;}
    button:active{transform:translateY(1px)}
    .status{font-size:13px;white-space:pre-line;margin-top:10px;}
    pre#model-info{background:#fff;padding:8px;border-radius:6px;font-size:12px;overflow:auto;max-height:160px;}
    #preview-row{display:flex;flex-direction:row;gap:12px;align-items:flex-start;overflow:auto;padding:6px 0;}
    .preview-item{display:flex;flex-direction:column;align-items:center;gap:6px;width:96px;}
    .preview-item canvas{width:96px;height:96px;border:1px solid rgba(0,0,0,0.06);background:white;border-radius:6px;}
    .correct{color:var(--success);font-weight:700;}
    .wrong{color:var(--danger);font-weight:700;}
    .small{font-size:13px;color:#333;}
    footer{font-size:12px;padding:8px 18px;color:#333;text-align:center;}
    /* Make tfjs-vis visor toggle not overlap content drastically */
    #visor-toggle {margin-top:6px;}
    @media (max-width:900px){
      main{flex-direction:column;height:auto;}
      .left{max-width:none;}
    }
  </style>
</head>
<body>
  <header>MNIST CNN Classifier & Denoising Autoencoder — Browser-only (tfjs)</header>

  <main>
    <section class="col left" aria-label="controls">
      <h2>Controls</h2>
      <div class="controls">
        <label>
          Upload Train CSV
          <input type="file" id="train-csv" accept=".csv" />
        </label>
        <label>
          Upload Test CSV
          <input type="file" id="test-csv" accept=".csv" />
        </label>

        <button id="load-data">Load Data</button>
        <button id="train-cnn">Train CNN</button>
        <button id="train-denoiser">Train Denoiser (Autoencoder)</button>
        <button id="evaluate">Evaluate</button>
        <button id="test-five">Test 5 Random</button>

        <button id="save-model">Save Model (Download)</button>
        <label>
          Upload Model JSON
          <input type="file" id="upload-json" accept=".json" />
        </label>
        <label>
          Upload Weights BIN
          <input type="file" id="upload-weights" accept=".bin" />
        </label>
        <button id="load-model">Load Model (From Files)</button>

        <button id="reset" class="secondary">Reset</button>
        <button id="toggle-visor" class="secondary" id="visor-toggle">Toggle Visor</button>
      </div>

      <div class="status" id="data-status" aria-live="polite"></div>
      <div class="status" id="training-logs" aria-live="polite"></div>
    </section>

    <section class="col right" aria-label="outputs">
      <h2>Status & Outputs</h2>
      <div id="metrics" class="small"></div>

      <h3 style="margin-top:12px;font-size:14px;">Random 5 Preview</h3>
      <div id="preview-row" role="list"></div>

      <h3 style="margin-top:12px;font-size:14px;">Model Info</h3>
      <pre id="model-info"></pre>

      <h3 style="margin-top:12px;font-size:14px;">Visor (tfjs-vis)</h3>
      <div style="font-size:12px;color:#666;margin-top:6px;">Use the visor window to view live charts. Click "Toggle Visor" to open/close.</div>
    </section>
  </main>

  <footer>Client-only demo • Provide local CSVs (mnist_train.csv & mnist_test.csv) • No network fetch</footer>

  <!-- App scripts (defer) -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
  <script src="data-loader.js"></script>
  <script src="app.js"></script>
</body>
</html>
